mutate(indicator="Education") %>%
rename(indicator1=mothers.education)
vacc_24_35_wealth.quintile.1
vacc_24_35_wealth.quintile.1 <- read_csv("table11_vacc_24_35_wealth.quintile.csv") %>%
mutate(group="24-35 months") %>%
mutate(indicator="Wealth quintile") %>%
rename(indicator1=wealth.quintile)
## join all the data
vaccination_data <- rbind(vacc_12_23_gender.1 , vacc_12_23_birth.1, vacc_12_23_card.1, vacc_12_23_mothers.education.1,vacc_12_23_residence.1, vacc_12_23_wealth.quintile.1, vacc_24_35_gender.1, vacc_24_35_birth.1, vacc_24_35_card.1, vacc_24_35_mothers.education.1, vacc_24_35_gender.1, vacc_24_35_residence.1, vacc_24_35_wealth.quintile.1)
selectInput("vacc", "",
c("Fully vaccinated: 12-23 months"="CountyFullyVaccinated12",
"Fully vaccinated: 24-35 months"="CountyFullyVaccinated24"))
vacc <- read_csv("table11C_vaccinationbycounty.csv")%>%
mutate(County=recode(NAME_1,"Tharaka-Nithi"="Tharaka Nithi", "Elgeyo/Marakwet"="Elgeyo Marakwet","Murang’a"="Muranga","Nairobi City"="Nairobi","Taita/Taveta"="Taita Taveta"))%>%
pivot_longer(c(CountyFullyVaccinated12,CountyFullyVaccinated24 ),names_to ="indicators", values_to="values") %>%
mutate(names1=paste0(County,", ", values,"%"))
vacc1<- full_join(county, vacc, by=c("Name"="County"))%>%
mutate(values=as.numeric(parse_number(values)))
table(vacc$indicators)
vacc <- read_csv("table11C_vaccinationbycounty.csv")%>%
mutate(County=recode(NAME_1,"Tharaka-Nithi"="Tharaka Nithi", "Elgeyo/Marakwet"="Elgeyo Marakwet","Murang’a"="Muranga","Nairobi City"="Nairobi","Taita/Taveta"="Taita Taveta"))%>%
pivot_longer(c(CountyFullyVaccinated12,CountyFullyVaccinated24 ),names_to ="indicators", values_to="values") %>%
mutate(names1=paste0(County,", ", values,"%"))
names(vacc)
county <- st_read("County.shp")
vacc1<- full_join(county, vacc, by=c("Name"="NAME_1"))%>%
mutate(values=as.numeric(parse_number(values)))
vacc_12_23_gender.1 <- read_csv("table11_vacc_12_23_gender.csv") %>%
mutate(group="12-23 months") %>%
mutate(indicator="Gender")
vacc_12_23_birth.1 <- read_csv("table11_vacc_12_23_birth.csv") %>%
mutate(group="12-23 months")  %>%
mutate(indicator="Birth")
vacc_12_23_card.1 <- read_csv("table11_vacc_12_23_card.csv") %>%
mutate(group="12-23 months")  %>%
mutate(indicator="Card")
vacc_12_23_residence.1 <- read_csv("table11_vacc_12_23_residence.csv") %>%
mutate(group="12-23 months")  %>%
mutate(indicator="Residence")
vacc_12_23_mothers.education.1 <- read_csv("table11_vacc_12_23_mothers.education.csv") %>%
mutate(group="12-23 months")  %>%
mutate(indicator="Education")
vacc_12_23_wealth.quintile.1 <- read_csv("table11_vacc_12_23_wealth.quintile.csv") %>%
mutate(group="12-23 months")  %>%
mutate(indicator="Wealth quintile")
vacc_24_35_gender.1 <- read_csv("table11_vacc_24_35_gender.csv") %>%
mutate(group="24-35 months")  %>%
mutate(indicator="Gender") %>%
rename(indicator1=Sex)
vacc_24_35_birth.1 <- read_csv("table11_vacc_24_35_birth.csv") %>%
mutate(group="24-35 months")  %>%
mutate(indicator="Birth") %>%
rename(indicator1=birth.order)
vacc_24_35_card.1 <- read_csv("table11_vacc_24_35_card.csv") %>%
mutate(group="24-35 months")  %>%
mutate(indicator="Card") %>%
rename(indicator1=vaccination.card)
vacc_24_35_residence.1 <- read_csv("table11_vacc_24_35_residence.csv") %>%
mutate(group="24-35 months") %>%
mutate(indicator="Residence") %>%
rename(indicator1=residence)
vacc_24_35_mothers.education.1 <- read_csv("table11_vacc_24_35_mothers.education.csv") %>%
mutate(group="24-35 months") %>%
mutate(indicator="Education") %>%
rename(indicator1=mothers.education)
vacc_24_35_wealth.quintile.1 <- read_csv("table11_vacc_24_35_wealth.quintile.csv") %>%
mutate(group="24-35 months") %>%
mutate(indicator="Wealth quintile") %>%
rename(indicator1=wealth.quintile)
## join all the data
vaccination_data <- rbind(vacc_12_23_gender.1 , vacc_12_23_birth.1, vacc_12_23_card.1, vacc_12_23_mothers.education.1,vacc_12_23_residence.1, vacc_12_23_wealth.quintile.1, vacc_24_35_gender.1, vacc_24_35_birth.1, vacc_24_35_card.1, vacc_24_35_mothers.education.1, vacc_24_35_gender.1, vacc_24_35_residence.1, vacc_24_35_wealth.quintile.1)
vacc_12_23_gender.1 <- read_csv("table11_vacc_12_23_gender.csv") %>%
mutate(group="12-23 months") %>%
mutate(indicator="Gender")
vacc_12_23_birth.1 <- read_csv("table11_vacc_12_23_birth.csv") %>%
mutate(group="12-23 months")  %>%
mutate(indicator="Birth")
vacc_12_23_card.1 <- read_csv("table11_vacc_12_23_card.csv") %>%
mutate(group="12-23 months")  %>%
mutate(indicator="Card")
vacc_12_23_residence.1 <- read_csv("table11_vacc_12_23_residence.csv") %>%
mutate(group="12-23 months")  %>%
mutate(indicator="Residence")
vacc_12_23_mothers.education.1 <- read_csv("table11_vacc_12_23_mothers.education.csv") %>%
mutate(group="12-23 months")  %>%
mutate(indicator="Education")
vacc_12_23_wealth.quintile.1 <- read_csv("table11_vacc_12_23_wealth.quintile.csv") %>%
mutate(group="12-23 months")  %>%
mutate(indicator="Wealth quintile")
vacc_24_35_gender.1 <- read_csv("table11_vacc_24_35_gender.csv") %>%
mutate(group="24-35 months")  %>%
mutate(indicator="Gender") %>%
rename(indicator1=Sex)
vacc_24_35_birth.1 <- read_csv("table11_vacc_24_35_birth.csv") %>%
mutate(group="24-35 months")  %>%
mutate(indicator="Birth") %>%
rename(indicator1=birth.order)
vacc_24_35_card.1 <- read_csv("table11_vacc_24_35_card.csv") %>%
mutate(group="24-35 months")  %>%
mutate(indicator="Card") %>%
rename(indicator1=vaccination.card)
vacc_24_35_card.1 <- read_csv("table11_vacc_24_35_card.csv")
names(vacc_24_35_card.1)
vacc_24_35_card.1 <- read_csv("table11_vacc_24_35_card.csv") %>%
mutate(group="24-35 months")  %>%
mutate(indicator="Card") %>%
rename(indicator1=vaccination.card)
vacc_24_35_card.1 <- read_csv("table11_vacc_24_35_card.csv") %>%
mutate(group="24-35 months")  %>%
mutate(indicator="Card")
vacc_24_35_card.1 <- read_csv("table11_vacc_24_35_card.csv") %>%
mutate(group="24-35 months")  %>%
mutate(indicator="Card") %>%
rename(indicator1=vacciantion.card)
vacc_24_35_residence.1 <- read_csv("table11_vacc_24_35_residence.csv") %>%
mutate(group="24-35 months") %>%
mutate(indicator="Residence") %>%
rename(indicator1=residence)
vacc_24_35_mothers.education.1 <- read_csv("table11_vacc_24_35_mothers.education.csv") %>%
mutate(group="24-35 months") %>%
mutate(indicator="Education") %>%
rename(indicator1=mothers.education)
vacc_24_35_wealth.quintile.1 <- read_csv("table11_vacc_24_35_wealth.quintile.csv") %>%
mutate(group="24-35 months") %>%
mutate(indicator="Wealth quintile") %>%
rename(indicator1=wealth.quintile)
## join all the data
vaccination_data <- rbind(vacc_12_23_gender.1 , vacc_12_23_birth.1, vacc_12_23_card.1, vacc_12_23_mothers.education.1,vacc_12_23_residence.1, vacc_12_23_wealth.quintile.1, vacc_24_35_gender.1, vacc_24_35_birth.1, vacc_24_35_card.1, vacc_24_35_mothers.education.1, vacc_24_35_gender.1, vacc_24_35_residence.1, vacc_24_35_wealth.quintile.1)
vacc_12_23_gender.1
vacc_24_35_gender.1 <- read_csv("table11_vacc_24_35_gender.csv") %>%
mutate(group="24-35 months")  %>%
mutate(indicator="Gender") %>%
rename(indicator1=Sex)
vacc_12_23_gender.1 <- read_csv("table11_vacc_12_23_gender.csv") %>%
mutate(group="12-23 months") %>%
mutate(indicator="Gender") %>%
rename(indicator1=Sex)
vacc_12_23_birth.1
vacc_12_23_birth.1 <- read_csv("table11_vacc_12_23_birth.csv") %>%
mutate(group="12-23 months")  %>%
mutate(indicator="Birth") %>%
rename(indicator1=birth.order)
vacc_12_23_card.1
vacc_12_23_card.1 <- read_csv("table11_vacc_12_23_card.csv") %>%
mutate(group="12-23 months")  %>%
mutate(indicator="Card") %>%
mutate(indicator1=vacciantion.card)
vacc_12_23_residence.1
vacc_12_23_residence.1 <- read_csv("table11_vacc_12_23_residence.csv") %>%
mutate(group="12-23 months")  %>%
mutate(indicator="Residence") %>%
rename(indicator1=residence)
vacc_12_23_mothers.education.1
vacc_12_23_mothers.education.1 <- read_csv("table11_vacc_12_23_mothers.education.csv") %>%
mutate(group="12-23 months")  %>%
mutate(indicator="Education") %>%
rename(indicator1=mothers.education)
vacc_12_23_wealth.quintile.1
vacc_12_23_wealth.quintile.1 <- read_csv("table11_vacc_12_23_wealth.quintile.csv") %>%
mutate(group="12-23 months")  %>%
mutate(indicator="Wealth quintile") %>%
rename(indicator1=wealth.quintile)
vacc_24_35_gender.1 <- read_csv("table11_vacc_24_35_gender.csv") %>%
mutate(group="24-35 months")  %>%
mutate(indicator="Gender") %>%
rename(indicator1=Sex)
vacc_24_35_birth.1 <- read_csv("table11_vacc_24_35_birth.csv") %>%
mutate(group="24-35 months")  %>%
mutate(indicator="Birth") %>%
rename(indicator1=birth.order)
vacc_24_35_card.1 <- read_csv("table11_vacc_24_35_card.csv") %>%
mutate(group="24-35 months")  %>%
mutate(indicator="Card") %>%
rename(indicator1=vacciantion.card)
vacc_24_35_residence.1 <- read_csv("table11_vacc_24_35_residence.csv") %>%
mutate(group="24-35 months") %>%
mutate(indicator="Residence") %>%
rename(indicator1=residence)
vacc_24_35_mothers.education.1 <- read_csv("table11_vacc_24_35_mothers.education.csv") %>%
mutate(group="24-35 months") %>%
mutate(indicator="Education") %>%
rename(indicator1=mothers.education)
vacc_24_35_wealth.quintile.1 <- read_csv("table11_vacc_24_35_wealth.quintile.csv") %>%
mutate(group="24-35 months") %>%
mutate(indicator="Wealth quintile") %>%
rename(indicator1=wealth.quintile)
## join all the data
vaccination_data <- rbind(vacc_12_23_gender.1 , vacc_12_23_birth.1, vacc_12_23_card.1, vacc_12_23_mothers.education.1,vacc_12_23_residence.1, vacc_12_23_wealth.quintile.1, vacc_24_35_gender.1, vacc_24_35_birth.1, vacc_24_35_card.1, vacc_24_35_mothers.education.1, vacc_24_35_gender.1, vacc_24_35_residence.1, vacc_24_35_wealth.quintile.1)
vacc_12_23_gender.1
vacc_12_23_card.1
vacc_24_35_card.1 <- read_csv("table11_vacc_24_35_card.csv") %>%
mutate(group="24-35 months")  %>%
mutate(indicator="Card") %>%
rename(indicator1=vacciantion.card)
## join all the data
vaccination_data <- rbind(vacc_12_23_gender.1 , vacc_12_23_birth.1, vacc_12_23_card.1, vacc_12_23_mothers.education.1,vacc_12_23_residence.1, vacc_12_23_wealth.quintile.1, vacc_24_35_gender.1, vacc_24_35_birth.1, vacc_24_35_card.1, vacc_24_35_mothers.education.1, vacc_24_35_gender.1, vacc_24_35_residence.1, vacc_24_35_wealth.quintile.1)
vacc_12_23_card.1 <- read_csv("table11_vacc_12_23_card.csv") %>%
mutate(group="12-23 months")  %>%
mutate(indicator="Card") %>%
rename(indicator1=vacciantion.card)
## join all the data
vaccination_data <- rbind(vacc_12_23_gender.1 , vacc_12_23_birth.1, vacc_12_23_card.1, vacc_12_23_mothers.education.1,vacc_12_23_residence.1, vacc_12_23_wealth.quintile.1, vacc_24_35_gender.1, vacc_24_35_birth.1, vacc_24_35_card.1, vacc_24_35_mothers.education.1, vacc_24_35_gender.1, vacc_24_35_residence.1, vacc_24_35_wealth.quintile.1)
head(vaccination_data)
table(vaccination_data$indicator)
ggplot(vaccination_data[vaccination_data$indicator%in%"Birth",],aes(x=Vaccines, y=Percent, fill=group)) +
geom_bar(stat = "identity", position = position_dodge())+#, fill="cyan4") +
theme_bw() +
geom_text(aes(label=Percent), hjust=1.3, size=5, color="black")+
scale_fill_brewer(palette = "Set1")+
coord_flip() +
ylab("Proportion") + xlab("") +
facet_wrap(~indicator1) +
theme(strip.text.x = element_text(size = 16, colour = "black", face = "bold")) +
theme(strip.text.y = element_text(size = 16, colour = "black", face = "bold")) +
theme(axis.title=element_text(size=18, face="bold"), axis.text = element_text(face = "bold", size = rel(1.5))) +
theme(strip.background =element_rect(fill="darkorange"))
ggplot(vaccination_data[vaccination_data$indicator%in%"Birth" & !is.na(vaccination_data$Percent),],aes(x=Vaccines, y=Percent, fill=group)) +
geom_bar(stat = "identity", position = position_dodge())+#, fill="cyan4") +
theme_bw() +
geom_text(aes(label=Percent), hjust=1.3, size=5, color="black")+
scale_fill_brewer(palette = "Set1")+
coord_flip() +
ylab("Proportion") + xlab("") +
facet_grid(~indicator1) +
theme(strip.text.x = element_text(size = 16, colour = "black", face = "bold")) +
theme(strip.text.y = element_text(size = 16, colour = "black", face = "bold")) +
theme(axis.title=element_text(size=18, face="bold"), axis.text = element_text(face = "bold", size = rel(1.5))) +
theme(strip.background =element_rect(fill="darkorange"))
ggplot(vaccination_data[vaccination_data$indicator%in%"Birth" & !is.na(vaccination_data$Percent),],aes(x=Vaccines, y=Percent, fill=group)) +
geom_bar(stat = "identity", position = position_dodge())+#, fill="cyan4") +
theme_bw() +
geom_text(aes(label=Percent), hjust=1.3, size=5, color="black")+
scale_fill_brewer(palette = "Set1")+
coord_flip() + labs(y="Proportion", x="", fill="")+
theme(strip.text.x = element_text(size = 16, colour = "black", face = "bold")) +
theme(strip.text.y = element_text(size = 16, colour = "black", face = "bold")) +
theme(axis.title=element_text(size=18, face="bold"), axis.text = element_text(face = "bold", size = rel(1.5))) +
theme(strip.background =element_rect(fill="darkorange"))
ggplot(vaccination_data[vaccination_data$indicator%in%"Birth" & !is.na(vaccination_data$indicator1),],aes(x=Vaccines, y=Percent, fill=group)) +
geom_bar(stat = "identity", position = position_dodge())+#, fill="cyan4") +
theme_bw() +
geom_text(aes(label=Percent), hjust=1.3, size=5, color="black")+
scale_fill_brewer(palette = "Set1")+
coord_flip() + labs(y="Proportion", x="", fill="")+
theme(strip.text.x = element_text(size = 16, colour = "black", face = "bold")) +
theme(strip.text.y = element_text(size = 16, colour = "black", face = "bold")) +
theme(axis.title=element_text(size=18, face="bold"), axis.text = element_text(face = "bold", size = rel(1.5))) +
theme(strip.background =element_rect(fill="darkorange"))
ggplot(vaccination_data[vaccination_data$indicator%in%"Birth",],aes(x=Vaccines, y=Percent, fill=group)) +
geom_bar(stat = "identity", position = position_dodge())+#, fill="cyan4") +
theme_bw() +
geom_text(aes(label=Percent), hjust=1.3, size=5, color="black")+
scale_fill_brewer(palette = "Set1")+
coord_flip() + labs(y="Proportion", x="", fill="")+
theme(strip.text.x = element_text(size = 16, colour = "black", face = "bold")) +
theme(strip.text.y = element_text(size = 16, colour = "black", face = "bold")) +
theme(axis.title=element_text(size=18, face="bold"), axis.text = element_text(face = "bold", size = rel(1.5))) +
theme(strip.background =element_rect(fill="darkorange"))
View(vaccination_data)
head(vaccination_data)
ggplot(vaccination_data[vaccination_data$indicator%in%"Birth",],aes(x=Vaccines, y=Percent, fill=group)) +
geom_bar(stat = "identity", position = position_dodge())+#, fill="cyan4") +
theme_bw() +
geom_text(aes(label=Percent), hjust=1.3, size=5, color="black")+
scale_fill_brewer(palette = "Set1")+facet_grid(~indicator1)+
coord_flip() + labs(y="Proportion", x="", fill="")+
theme(strip.text.x = element_text(size = 16, colour = "black", face = "bold")) +
theme(strip.text.y = element_text(size = 16, colour = "black", face = "bold")) +
theme(axis.title=element_text(size=18, face="bold"), axis.text = element_text(face = "bold", size = rel(1.5))) +
theme(strip.background =element_rect(fill="darkorange"))
table(vaccination_data$indicator1)
ggplot(vaccination_data[vaccination_data$indicator%in%"Birth" & !is.na(vaccination_data$indicator1),],aes(x=Vaccines, y=Percent, fill=group)) +
geom_bar(stat = "identity", position = position_dodge())+#, fill="cyan4") +
theme_bw() +
geom_text(aes(label=Percent), hjust=1.3, size=5, color="black")+
scale_fill_brewer(palette = "Set1")+facet_grid(~indicator1)+
coord_flip() + labs(y="Proportion", x="", fill="")+
theme(strip.text.x = element_text(size = 16, colour = "black", face = "bold")) +
theme(strip.text.y = element_text(size = 16, colour = "black", face = "bold")) +
theme(axis.title=element_text(size=18, face="bold"), axis.text = element_text(face = "bold", size = rel(1.5))) +
theme(strip.background =element_rect(fill="darkorange"))
ggplot(vaccination_data[vaccination_data$indicator%in%"Birth" & !is.na(vaccination_data$indicator1),],aes(x=Vaccines, y=Percent, fill=group)) +
geom_bar(stat = "identity", position = position_dodge())+#, fill="cyan4") +
theme_bw() +
geom_text(aes(label=Percent), position=position_stack(hjust=0.3), size=5, color="black")+
scale_fill_brewer(palette = "Set1")+facet_grid(~indicator1)+
coord_flip() + labs(y="Proportion", x="", fill="")+
theme(strip.text.x = element_text(size = 16, colour = "black", face = "bold")) +
theme(strip.text.y = element_text(size = 16, colour = "black", face = "bold")) +
theme(axis.title=element_text(size=18, face="bold"), axis.text = element_text(face = "bold", size = rel(1.5))) +
theme(strip.background =element_rect(fill="darkorange"))
ggplot(vaccination_data[vaccination_data$indicator%in%"Birth" & !is.na(vaccination_data$indicator1),],aes(x=Vaccines, y=Percent, fill=group)) +
geom_bar(stat = "identity", position = position_dodge())+#, fill="cyan4") +
theme_bw() +
geom_text(aes(label=Percent), position=position_stack(), size=5, color="black")+
scale_fill_brewer(palette = "Set1")+facet_grid(~indicator1)+
coord_flip() + labs(y="Proportion", x="", fill="")+
theme(strip.text.x = element_text(size = 16, colour = "black", face = "bold")) +
theme(strip.text.y = element_text(size = 16, colour = "black", face = "bold")) +
theme(axis.title=element_text(size=18, face="bold"), axis.text = element_text(face = "bold", size = rel(1.5))) +
theme(strip.background =element_rect(fill="darkorange"))
vacc <- read_csv("table11C_vaccinationbycounty.csv")%>%
mutate(County=recode(NAME_1,"Tharaka-Nithi"="Tharaka Nithi", "Elgeyo/Marakwet"="Elgeyo Marakwet","Murang’a"="Muranga","Nairobi City"="Nairobi","Taita/Taveta"="Taita Taveta"))%>%
pivot_longer(c(CountyFullyVaccinated12,CountyFullyVaccinated24 ),names_to ="indicators", values_to="values") %>%
mutate(names1=paste0(County,", ", values,"%"))
vacc1<- full_join(county, vacc, by=c("Name"="NAME_1"))%>%
mutate(values=as.numeric(parse_number(values)))
county <- st_read("County.shp")
vacc1<- full_join(county, vacc, by=c("Name"="NAME_1"))%>%
mutate(values=as.numeric(parse_number(values)))
vacc <- read_csv("table11C_vaccinationbycounty.csv")%>%
mutate(County=recode(NAME_1,"Tharaka-Nithi"="Tharaka Nithi", "Elgeyo/Marakwet"="Elgeyo Marakwet","Murang’a"="Muranga","Nairobi City"="Nairobi","Taita/Taveta"="Taita Taveta"))%>%
pivot_longer(c(CountyFullyVaccinated12,CountyFullyVaccinated24 ),names_to ="indicators", values_to="values") %>%
mutate(names1=paste0(County,", ", values,"%"))
setwd("~/Dropbox/GitHub/2022_KDHS")
vacc <- read_csv("table11C_vaccinationbycounty.csv")%>%
mutate(County=recode(NAME_1,"Tharaka-Nithi"="Tharaka Nithi", "Elgeyo/Marakwet"="Elgeyo Marakwet","Murang’a"="Muranga","Nairobi City"="Nairobi","Taita/Taveta"="Taita Taveta"))%>%
pivot_longer(c(CountyFullyVaccinated12,CountyFullyVaccinated24 ),names_to ="indicators", values_to="values") %>%
mutate(names1=paste0(County,", ", values,"%"))
names(vacc)
vacc1<- full_join(county, vacc, by=c("Name"="NAME_1"))%>%
mutate(values=as.numeric(parse_number(values)))
table(vacc1$indicators)
map3<- ggplot(vacc1[vacc1$indicators%in%"CountyFullyVaccinated12",])+
geom_sf_interactive(aes(fill=values, tooltip=names1),color="grey80", size=0.0)+
theme_void()+
scale_fill_gradient(low = "white", high = "#8c2d04")+
labs(x="", y="",fill="Proportion")+
theme(text=element_text(size=14))
x <- girafe(ggobj = map3,
options = list(
opts_hover(css = "fill:#666666;cursor:pointer;"),
opts_selection(css = "fill:orange;", type = "multiple"),
opts_zoom(max = 4)), width=6, height=3)
x<-ggobj = map3
x<- girafe(ggobj = map3)
map3
vacc1[vacc1$indicators%in%"CountyFullyVaccinated12",]
map3<- ggplot(vacc1[vacc1$indicators%in%"CountyFullyVaccinated12",])+
geom_sf=(aes(fill=values, tooltip=names1),color="grey80", size=0.0)+
theme_void()+
scale_fill_gradient(low = "white", high = "#8c2d04")+
labs(x="", y="",fill="Proportion")+
theme(text=element_text(size=14))
map3<- ggplot(vacc1[vacc1$indicators%in%"CountyFullyVaccinated12",])+
geom_sf(aes(fill=values, tooltip=names1),color="grey80", size=0.0)+
theme_void()+
scale_fill_gradient(low = "white", high = "#8c2d04")+
labs(x="", y="",fill="Proportion")+
theme(text=element_text(size=14))
map3
vacc1<- full_join(county, vacc, by=c("Name"="County"))%>%
mutate(values=as.numeric(parse_number(values)))
map3<- ggplot(vacc1[vacc1$indicators%in%"CountyFullyVaccinated12",])+
geom_sf(aes(fill=values, tooltip=names1),color="grey80", size=0.0)+
theme_void()+
scale_fill_gradient(low = "white", high = "#8c2d04")+
labs(x="", y="",fill="Proportion")+
theme(text=element_text(size=14))
map3
map3<- ggplot(vacc1[vacc1$indicators%in%"CountyFullyVaccinated12",])+
geom_sf_interactive(aes(fill=values, tooltip=names1),color="grey80", size=0.0)+
theme_void()+
scale_fill_gradient(low = "white", high = "#8c2d04")+
labs(x="", y="",fill="Proportion")+
theme(text=element_text(size=14))
print(map3)
map3<- ggplot(vacc1[vacc1$indicators%in%"CountyFullyVaccinated12",])+
geom_sf_interactive(aes(fill=values, tooltip=names1),color="grey80", size=0.0)+
theme_void()+
scale_fill_gradient(low = "white", high = "#8c2d04")+
labs(x="", y="",fill="Proportion")+
theme(text=element_text(size=14))
x <- girafe(ggobj = map3,
options = list(
opts_hover(css = "fill:#666666;cursor:pointer;"),
opts_selection(css = "fill:orange;", type = "multiple"),
opts_zoom(max = 4)), width=6, height=3)
renderGirafe({
map3<- ggplot(vacc1[vacc1$indicators%in%"CountyFullyVaccinated12",])+
geom_sf_interactive(aes(fill=values, tooltip=names1),color="grey80", size=0.0)+
theme_void()+
scale_fill_gradient(low = "white", high = "#8c2d04")+
labs(x="", y="",fill="Proportion")+
theme(text=element_text(size=14))
x <- girafe(ggobj = map3,
options = list(
opts_hover(css = "fill:#666666;cursor:pointer;"),
opts_selection(css = "fill:orange;", type = "multiple"),
opts_zoom(max = 4)), width=6, height=3)
print(x)})
print(x)
View(vaccination_data)
View(vacc1)
hiv_testc <- read_csv("table25C .1 and .2_HIV_test_bind.csv")%>%
mutate(County=recode(County,"Tharaka-Nithi"="Tharaka Nithi", "Elgeyo/Marakwet"="Elgeyo Marakwet","Murang’a"="Muranga","Nairobi City"="Nairobi","Taita/Taveta"="Taita Taveta"))%>%
pivot_longer(c(ever_tested, recieved_results,received_results_last_test ), names_to ="indicators", values_to="values") %>%
mutate(names1=paste0(County,", ", values,"%"))
hiv_testc1 <- full_join(county, hiv_testc, by="County")
hiv_testc1 <- full_join(county, hiv_testc, by=c("Name"="County"))
table(hiv_testc1$indicators)
hiv_testc <- read_csv("table25C .1 and .2_HIV_test_bind.csv")%>%
mutate(County=recode(County,"Tharaka-Nithi"="Tharaka Nithi", "Elgeyo/Marakwet"="Elgeyo Marakwet","Murang’a"="Muranga","Nairobi City"="Nairobi","Taita/Taveta"="Taita Taveta"))%>%
pivot_longer(c(ever_tested, recieved_results,received_results_last_test ), names_to ="indicators", values_to="values") %>%
mutate(names1=paste0(County,", ", values,"%"))
hiv_testc1 <- full_join(county, hiv_testc, by=c("Name"="County"))
table(hiv_testc1$indicators)
hiv_testc <- read_csv("table25C .1 and .2_HIV_test_bind.csv")%>%
mutate(County=recode(County,"Tharaka-Nithi"="Tharaka Nithi", "Elgeyo/Marakwet"="Elgeyo Marakwet","Murang’a"="Muranga","Nairobi City"="Nairobi","Taita/Taveta"="Taita Taveta"))%>%
pivot_longer(c(ever_tested, recieved_results,received_results_last_test ), names_to ="indicators", values_to="values") %>%
mutate(names1=paste0(County,", ", values,"%"))
hiv_testc1 <- full_join(county, hiv_testc, by=c("Name"="County"))
head(hiv_testc1)
hiv_testc <- read_csv("table25C .1 and .2_HIV_test_bind.csv")%>%
mutate(County=recode(County,"Tharaka-Nithi"="Tharaka Nithi", "Elgeyo/Marakwet"="Elgeyo Marakwet","Murang’a"="Muranga","Nairobi City"="Nairobi","Taita/Taveta"="Taita Taveta"))%>%
pivot_longer(c(ever_tested, recieved_results,received_results_last_test ), names_to ="indicators", values_to="values") %>%
mutate(names1=paste0(County,", ", values,"%")) %>%
mutate(Participants=str_to_title(Participants))
hiv_testc1 <- full_join(county, hiv_testc, by=c("Name"="County"))
map2<- ggplot(hiv_testc1[hiv_testc1$indicators%in%"ever_tested",])+
geom_sf_interactive(aes(fill=values, tooltip=names1),color="grey80", size=0.0)+
theme_void()+facet_grid(.~Participants)+
scale_fill_gradient(low = "white", high = "#8c2d04")+
labs(x="", y="",fill="Proportion")+
theme(text=element_text(size=14))
map2
map2<- ggplot(hiv_testc1[hiv_testc1$indicators%in%"received_results_last_test",])+
geom_sf_interactive(aes(fill=values, tooltip=names1),color="grey80", size=0.0)+
theme_void()+facet_grid(.~Participants)+
scale_fill_gradient(low = "white", high = "#8c2d04")+
labs(x="", y="",fill="Proportion")+
theme(text=element_text(size=14))
map2
hiv_testc1 <- full_join(county, hiv_testc, by=c("Name"="County")) %>%
mutate(values=as.numeric(parse_number(values)))
hiv_testc1 <- full_join(county, hiv_testc, by=c("Name"="County"))
View(hiv_testc1)
hiv_testc <- read_csv("table25C .1 and .2_HIV_test_bind.csv")%>%
mutate(County=recode(County,"Tharaka-Nithi"="Tharaka Nithi", "Elgeyo/Marakwet"="Elgeyo Marakwet","Murang’a"="Muranga","Nairobi City"="Nairobi","Taita/Taveta"="Taita Taveta"))%>%
pivot_longer(c(ever_tested, recieved_results,received_results_last_test ), names_to ="indicators", values_to="values") %>%
mutate(names1=paste0(County,", ", values,"%")) %>%
mutate(Participants=str_to_title(Participants))
head(hiv_testc)
hiv_testc <- read_csv("table25C .1 and .2_HIV_test_bind.csv")%>%
mutate(County=recode(County,"Tharaka-Nithi"="Tharaka Nithi", "Elgeyo/Marakwet"="Elgeyo Marakwet","Murang’a"="Muranga","Nairobi City"="Nairobi","Taita/Taveta"="Taita Taveta"))%>%
pivot_longer(c(ever_tested, recieved_results,received_results_last_test, never_tested, not_recieve_results ), names_to ="indicators", values_to="values") %>%
mutate(names1=paste0(County,", ", values,"%")) %>%
mutate(Participants=str_to_title(Participants))
head(hiv_testc)
View(hiv_testc)
hiv_testc <- read_csv("table25C .1 and .2_HIV_test_bind.csv")%>%
mutate(County=recode(County,"Tharaka-Nithi"="Tharaka Nithi", "Elgeyo/Marakwet"="Elgeyo Marakwet","Murang’a"="Muranga","Nairobi City"="Nairobi","Taita/Taveta"="Taita Taveta"))%>%
pivot_longer(c(ever_tested, recieved_results,received_results_last_test, never_tested, not_recieve_results ), names_to ="indicators", values_to="values") %>%
mutate(names1=paste0(County,", ", values,"%")) %>%
mutate(Participants=str_to_title(Participants))
head(hiv_testc)
map2<- ggplot(hiv_testc1[hiv_testc1$indicators%in%"received_results",])+
geom_sf_interactive(aes(fill=values, tooltip=names1),color="grey80", size=0.0)+
theme_void()+facet_grid(.~Participants)+
scale_fill_gradient(low = "white", high = "#8c2d04")+
labs(x="", y="",fill="Proportion")+
theme(text=element_text(size=14))
map2
head(hiv_testc1[hiv_testc1$indicators%in%"received_results",])
table(hiv_testc1$indicators)
hiv_testc <- read_csv("table25C .1 and .2_HIV_test_bind.csv")%>%
mutate(County=recode(County,"Tharaka-Nithi"="Tharaka Nithi", "Elgeyo/Marakwet"="Elgeyo Marakwet","Murang’a"="Muranga","Nairobi City"="Nairobi","Taita/Taveta"="Taita Taveta"))%>%
pivot_longer(c(ever_tested, recieved_results,received_results_last_test, never_tested, not_recieve_results ), names_to ="indicators", values_to="values") %>%
mutate(names1=paste0(County,", ", values,"%")) %>%
mutate(Participants=str_to_title(Participants))
table(hiv_testc1$indicators)
hiv_testc <- read_csv("table25C .1 and .2_HIV_test_bind.csv")
names(hiv_testc)
hiv_testc <- read_csv("table25C .1 and .2_HIV_test_bind.csv")%>%
mutate(County=recode(County,"Tharaka-Nithi"="Tharaka Nithi", "Elgeyo/Marakwet"="Elgeyo Marakwet","Murang’a"="Muranga","Nairobi City"="Nairobi","Taita/Taveta"="Taita Taveta"))%>%
pivot_longer(c(ever_tested, recieved_results,received_results_last_test, never_tested, not_recieve_results ), names_to ="indicators", values_to="values")
head(hiv_testc)
table(hiv_testc$indicators)
hiv_testc1 <- full_join(county, hiv_testc, by=c("Name"="County"))
renderGirafe({
map2<- ggplot(hiv_testc1[hiv_testc1$indicators%in%"recieved_results",])+
geom_sf_interactive(aes(fill=values, tooltip=names1),color="grey80", size=0.0)+
theme_void()+facet_grid(.~Participants)+
scale_fill_gradient(low = "white", high = "#8c2d04")+
labs(x="", y="",fill="Proportion")+
theme(text=element_text(size=14))
x <- girafe(ggobj = map2,
options = list(
opts_hover(css = "fill:#666666;cursor:pointer;"),
opts_selection(css = "fill:orange;", type = "multiple"),
opts_zoom(max = 4)), width=6, height=3)
print(x)})
map2<- ggplot(hiv_testc1[hiv_testc1$indicators%in%"recieved_results",])+
geom_sf_interactive(aes(fill=values, tooltip=names1),color="grey80", size=0.0)+
theme_void()+facet_grid(.~Participants)+
scale_fill_gradient(low = "white", high = "#8c2d04")+
labs(x="", y="",fill="Proportion")+
theme(text=element_text(size=14))
map2
hiv_testc <- read_csv("table25C .1 and .2_HIV_test_bind.csv")%>%
mutate(County=recode(County,"Tharaka-Nithi"="Tharaka Nithi", "Elgeyo/Marakwet"="Elgeyo Marakwet","Murang’a"="Muranga","Nairobi City"="Nairobi","Taita/Taveta"="Taita Taveta"))%>%
pivot_longer(c(ever_tested, recieved_results,received_results_last_test, never_tested, not_recieve_results ), names_to ="indicators", values_to="values") %>%
mutate(names1=paste0(County,", ", values,"%")) %>%
mutate(Participants=str_to_title(Participants))
hiv_testc1 <- full_join(county, hiv_testc, by=c("Name"="County"))
map2<- ggplot(hiv_testc1[hiv_testc1$indicators%in%"recieved_results",])+
geom_sf_interactive(aes(fill=values, tooltip=names1),color="grey80", size=0.0)+
theme_void()+facet_grid(.~Participants)+
scale_fill_gradient(low = "white", high = "#8c2d04")+
labs(x="", y="",fill="Proportion")+
theme(text=element_text(size=14))
map2
