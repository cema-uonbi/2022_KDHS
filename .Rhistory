ggplot(group_all, aes(x=group, y=value, fill=residence))+geom_col()+facet_grid(type~.)+geom_text(aes(label=format(value, big.mark=","), vjust=4))+theme_bw()+scale_fill_manual(values=c("#d8b365","#5ab4ac" ))+scale_y_continuous(label = comma)+labs(x="", y="Frequency", fill="Residence")+coord_flip()
# visualize the data, while grouping it by question type and residential area
ggplot(group_all, aes(x=group, y=value, fill=residence))+geom_col()+facet_grid(type~.)+geom_text(aes(label=format(value, big.mark=","), vjust=-4))+theme_bw()+scale_fill_manual(values=c("#d8b365","#5ab4ac" ))+scale_y_continuous(label = comma)+labs(x="", y="Frequency", fill="Residence")+coord_flip()
# visualize the data, while grouping it by question type and residential area
ggplot(group_all, aes(x=group, y=value, fill=residence))+geom_col()+facet_grid(type~.)+geom_text(aes(label=format(value, big.mark=","), vjust=4, hjust=-4))+theme_bw()+scale_fill_manual(values=c("#d8b365","#5ab4ac" ))+scale_y_continuous(label = comma)+labs(x="", y="Frequency", fill="Residence")+coord_flip()
# visualize the data, while grouping it by question type and residential area
ggplot(group_all, aes(x=group, y=value, fill=residence))+geom_col()+facet_grid(type~.)+geom_text(aes(label=format(value, big.mark=","), vjust=4, hjust=4))+theme_bw()+scale_fill_manual(values=c("#d8b365","#5ab4ac" ))+scale_y_continuous(label = comma)+labs(x="", y="Frequency", fill="Residence")+coord_flip()
# visualize the data, while grouping it by question type and residential area
ggplot(group_all, aes(x=group, y=value))+geom_col()+facet_grid(type~residence)+geom_text(aes(label=format(value, big.mark=","), vjust=4, hjust=4))+theme_bw()+scale_fill_manual(values=c("#5ab4ac" ))+scale_y_continuous(label = comma)+labs(x="", y="Frequency", fill="Residence")+coord_flip()+theme(text=element_text(size=16))
# visualize the data, while grouping it by question type and residential area
ggplot(group_all, aes(x=group, y=value))+geom_col(fill="#5ab4ac")+facet_grid(type~residence)+geom_text(aes(label=format(value, big.mark=","), vjust=4, hjust=4))+theme_bw()+scale_y_continuous(label = comma)+labs(x="", y="Frequency", fill="Residence")+coord_flip()+theme(text=element_text(size=16))
# data from table 1 that contains the number of respondents
group <- c("Women (15-49 years)","Women (15-49 years)", "Women (15-49 years)","Women (15-49 years)", "Men (15-54 years)","Men (15-54 years)", "Women (15-49 years)","Women (15-49 years)", "Men (15-54 years)","Men (15-54 years)")
value <- c(12386,19770, 6517,10384,5232, 9221, 5869, 9386,5232, 9221)
type <- c("All questionnaires","Full questionnaires","Full questionnaires","Full questionnaires","Full questionnaires", "Short questionnaires", "Short questionnaires", "All questionnaires", "All questionnaires")
residence <- c("Urban","Rural", "Urban", "Rural", "Urban", "Rural", "Urban", "Rural","Urban", "Rural")
group_all <- data.frame(group, value, type, residence)
type <- c("All questionnaires","All questionnaires", "Full questionnaires","Full questionnaires","Full questionnaires","Full questionnaires", "Short questionnaires", "Short questionnaires", "All questionnaires", "All questionnaires")
residence <- c("Urban","Rural", "Urban", "Rural", "Urban", "Rural", "Urban", "Rural","Urban", "Rural")
group_all <- data.frame(group, value, type, residence)
# visualize the data, while grouping it by question type and residential area
ggplot(group_all, aes(x=group, y=value))+geom_col(fill="#5ab4ac")+facet_grid(type~residence)+geom_text(aes(label=format(value, big.mark=","), vjust=4, hjust=4))+theme_bw()+scale_y_continuous(label = comma)+labs(x="", y="Frequency", fill="Residence")+coord_flip()+theme(text=element_text(size=16))
radioButtons("quest", "Choose type of questionnaire:",
c("All"="all",
"Full"="full",
"Short"="short"))
questInput <- reactive({
valueChosen <- input$quest
})
# visualize the data, while grouping it by question type and residential area
renderPlot({
ggplot(group_all[group_all$type%in%input$quest,], aes(x=group, y=value))+geom_col(fill="#5ab4ac")+facet_grid(type~residence)+geom_text(aes(label=format(value, big.mark=","), vjust=4, hjust=4))+theme_bw()+scale_y_continuous(label = comma)+labs(x="", y="Frequency", fill="Residence")+coord_flip()+theme(text=element_text(size=16))
})
knitr::opts_chunk$set(echo = TRUE)
kdhshouseholdinterviews <- read_csv("table1_dhshhinterviews.csv") %>%
dplyr::mutate(Households = recode(Households, "Households selected" = "Selected","Households occupied" = "Occupied", "Households interviewed" = "Interviewed"))
interviewvisuals <- kdhshouseholdinterviews %>%
ggplot(aes(x=Households, y=numbers)) +
geom_bar(stat = "identity", position = position_dodge(), fill="cyan4") +
theme_bw() +
geom_text(aes(label=numbers), hjust=1.3, size=5, color="white")+
coord_flip() +
ylab("") + xlab("Households") +
facet_grid(residence~selection) +
theme(strip.text.x = element_text(size = 16, colour = "black", face = "bold")) +
theme(strip.text.y = element_text(size = 16, colour = "black", face = "bold")) +
theme(axis.title=element_text(size=18, face="bold"), axis.text = element_text(face = "bold", size = rel(1.5))) +
theme(strip.background =element_rect(fill="darkorange"))
interviewvisuals
library(flexdashboard)
library(tidyverse)
library(scales)
kdhshouseholdinterviews <- read_csv("table1_dhshhinterviews.csv") %>%
dplyr::mutate(Households = recode(Households, "Households selected" = "Selected","Households occupied" = "Occupied", "Households interviewed" = "Interviewed"))
interviewvisuals <- kdhshouseholdinterviews %>%
ggplot(aes(x=Households, y=numbers)) +
geom_bar(stat = "identity", position = position_dodge(), fill="cyan4") +
theme_bw() +
geom_text(aes(label=numbers), hjust=1.3, size=5, color="white")+
coord_flip() +
ylab("") + xlab("Households") +
facet_grid(residence~selection) +
theme(strip.text.x = element_text(size = 16, colour = "black", face = "bold")) +
theme(strip.text.y = element_text(size = 16, colour = "black", face = "bold")) +
theme(axis.title=element_text(size=18, face="bold"), axis.text = element_text(face = "bold", size = rel(1.5))) +
theme(strip.background =element_rect(fill="darkorange"))
interviewvisuals
interviewvisuals
# visualization for women participants
womenparticipantsinterviewsvisuals <- participantsinterviews %>%
dplyr::filter(Gender == "Female") %>%
ggplot(aes(x=Respondents, y=numbers)) +
geom_bar(stat = "identity", position = position_dodge(), fill="cyan4") +
theme_bw() +
geom_text(aes(label=numbers), hjust=1.3, size=5, color="white")+
coord_flip() +
ylab("") + xlab("Respondents") +
facet_grid(residence~selection) +
theme(strip.text.x = element_text(size = 16, colour = "black", face = "bold")) +
theme(strip.text.y = element_text(size = 16, colour = "black", face = "bold")) +
theme(axis.title=element_text(size=18, face="bold"), axis.text = element_text(face = "bold", size = rel(1.5))) +
theme(strip.background =element_rect(fill="darkorange"))
participantsinterviews <- read_csv("table1_participantsinterviews.csv") %>%
dplyr::mutate(Participant = recode(Respondents, "Number of eligible women" = "Eligible women","Number of eligible women interviewed" = "Women interviewed", "Number of eligible men" = "Eligible men","Number of eligible men interviewed" = "Men interviewed"))
names(participantsinterviews)
participantsinterviews <- read_csv("table1_participantsinterviews.csv") %>%
dplyr::mutate(Participant = recode(Respondents, "Number of eligible women" = "Eligible women","Number of eligible women interviewed" = "Women interviewed", "Number of eligible men" = "Eligible men","Number of eligible men interviewed" = "Men interviewed"))
setwd("~/Dropbox/2014 DHS Data/2022_KDHS")
participantsinterviews <- read_csv("table1_participantsinterviews.csv") %>%
dplyr::mutate(Participant = recode(Respondents, "Number of eligible women" = "Eligible women","Number of eligible women interviewed" = "Women interviewed", "Number of eligible men" = "Eligible men","Number of eligible men interviewed" = "Men interviewed"))
participantsinterviews$Gender
kdhshouseholdinterviews <- read_csv("table1_dhshhinterviews.csv") %>%
dplyr::mutate(Households = recode(Households, "Households selected" = "Selected","Households occupied" = "Occupied", "Households interviewed" = "Interviewed"))
kdhshouseholdinterviews
participantsinterviews
View(participantsinterviews)
interviewvisuals <- kdhshouseholdinterviews %>%
mutate(group="All")
names(interviewvisuals)
names(participantsinterviews)
interviewvisuals <- kdhshouseholdinterviews %>%
mutate(Participant="All")
totalinterviewvisuals <- kdhshouseholdinterviews %>%
full_join(participantsinterviews, by=c("Participant"))
interviewvisuals <- kdhshouseholdinterviews %>%
mutate(Participant="All")
totalinterviewvisuals <- kdhshouseholdinterviews %>%
full_join(participantsinterviews, by=c("Participant"))
totalinterviewvisuals <- interviewvisuals %>%
full_join(participantsinterviews, by=c("Participant"))
View(interviewvisuals)
View(totalinterviewvisuals)
names(interviewvisuals)
names(participantsinterviews)
interviewvisuals <- kdhshouseholdinterviews %>%
mutate(Gender="All") %>%
mutate(Participant="All") %>%
rename(Households=Respondents)
totalinterviewvisuals <- rbind(interviewvisuals ,participantsinterviews)
names(interviewvisuals)
interviewvisuals <- kdhshouseholdinterviews %>%
mutate(Gender="All") %>%
mutate(Participant="All") %>%
rename(Households=Respondents)
interviewvisuals <- kdhshouseholdinterviews %>%
mutate(Gender="All") %>%
mutate(Participant="All") %>%
rename(Respondents=Households)
totalinterviewvisuals <- rbind(interviewvisuals ,participantsinterviews)
# join the two datasets
totalinterviewvisuals <- rbind(interviewvisuals ,participantsinterviews)
View(totalinterviewvisuals)
renderPlot({ggplot(totalinterviewvisuals[totalinterviewvisuals$Gender%in%input$quest,], aes(x=Respondents, y=numbers, fill=residence)) +
geom_bar(stat = "identity", position = position_dodge()) +
theme_bw() +
geom_text(aes(label=numbers), hjust=1.3, size=5, color="white")+
coord_flip() +
ylab("") + xlab("Households") +scale_fill_manual(values=c("#B26146", "black"))+
facet_grid(.~selection) +
theme(strip.text.x = element_text(size = 16, colour = "black", face = "bold")) +
theme(strip.text.y = element_text(size = 16, colour = "black", face = "bold")) +
theme(axis.title=element_text(size=18, face="bold"), axis.text = element_text(face = "bold", size = rel(1.5))) +
theme(strip.background =element_rect(fill="darkorange"))})
?geom_text
?renderPlot
# load all the required packages
library(pacman)
install.packages("pacman")
# load all the required packages
library(pacman)
p_load(docxtractr)
p_load(flexdashboard)
p_load(tidyverse)
p_load(ggiraph)
p_load(scales)
# load all the required packages
library(pacman)
p_load(docxtractr)
p_load(flexdashboard)
p_load(tidyverse)
p_load(ggiraph)
p_load(scales)
# import all the tables
dhs2022report <- read_docx("2022KDHSKIR_KNBS.docx")
# number of tables in the report
docx_tbl_count(dhs2022report)
tbls <- docx_extract_all_tbls(dhs2022report, trim = T, guess_header = T)
respondentsbyage <- read_csv("table2_ageparticipants.csv")
respondentsbyagevisuals <- respondentsbyage %>%
ggplot(aes(x=Age, y=Weighted_percent, color = Participants)) +
geom_point(stat = "identity", size= 4) +
theme_bw() +
geom_text(aes(label=Weighted_percent), hjust=-0.5, size=4, color="black")+
ylab("Weighted percent (%)") + xlab("Age of respondents") +
theme(axis.title=element_text(size=16, face="bold"), axis.text = element_text(face = "bold", size = rel(1.5)))
respondentsbyagevisuals
respondentsbyage <- read_csv("table2_ageparticipants.csv")
respondentsbyage <- read_csv("table2_ageparticipants.csv")
names(respondentsbyage)
## reported health status
healthstatus <- read_csv("table2_selfreport_healthstatus.csv") %>%
mutate(Health_status = fct_relevel(Health_status,
"Very bad","Bad","Moderate","Good","Very good"))
names(respondentsbyage)
names(healthstatus)
head(respondentsbyage)
# join the two datasets
respondentsdata <- rbind(respondentsbyage, healthstatus)
respondentsbyage <- read_csv("table2_ageparticipants.csv")%>%
mutate(Indicator="Age")%>%
rename(Grouping=Age)
# reported health status data
healthstatus <- read_csv("table2_selfreport_healthstatus.csv") %>%
mutate(Health_status = fct_relevel(Health_status,
"Very bad","Bad","Moderate","Good","Very good"))%>%
mutate(Indicator="Health_Status")%>%
rename(Grouping=Health_status)
# join the two datasets
respondentsdata <- rbind(respondentsbyage, healthstatus)
head(respondentsdata)
table(respondentsdata$Indicator)
# visualize the data
renderPlot({ggplot(respondentsdata[respondentsdata$Indicator=="Age",], aes(x=Group, y=Weighted_percent, color = Participants)) +
geom_point(stat = "identity", size= 4) +
theme_bw() +
geom_text(aes(label=Weighted_percent), hjust=-0.5, size=4, color="black")+
labs(y="Weighted percent (%)",x="Age of respondents", fill="Gender") +
theme(axis.title=element_text(size=16, face="bold"), axis.text = element_text(face = "bold", size = rel(1.5)))}, width = 2000, height=1000)
ggplot(respondentsdata[respondentsdata$Indicator=="Age",], aes(x=Group, y=Weighted_percent, color = Participants)) +
geom_point(stat = "identity", size= 4) +
theme_bw() +
geom_text(aes(label=Weighted_percent), hjust=-0.5, size=4, color="black")+
labs(y="Weighted percent (%)",x="Age of respondents", fill="Gender") +
theme(axis.title=element_text(size=16, face="bold"), axis.text = element_text(face = "bold", size = rel(1.5)))
# religion
religionrespondents <- read_csv("table2_religionparticipants.csv") %>%
mutate(Religion = fct_relevel(Religion, "Other","No religion", "Muslim","Catholic","Protestant/other Christian"))
names(religionrespondents)
names(respondentsdata)
respondentsdata <- rbind(respondentsbyage, healthstatus, religionrespondents)
# religion
religionrespondents <- read_csv("table2_religionparticipants.csv") %>%
mutate(Religion = fct_relevel(Religion, "Other","No religion", "Muslim","Catholic","Protestant/other Christian")) mutate(Indicator="Religion")%>%
# religion
religionrespondents <- read_csv("table2_religionparticipants.csv") %>%
mutate(Religion = fct_relevel(Religion, "Other","No religion", "Muslim","Catholic","Protestant/other Christian")) %>% mutate(Indicator="Religion")%>%
rename(Grouping=Religion)
respondentsdata <- rbind(respondentsbyage, healthstatus, religionrespondents)
# Marital status
maritalstatusrespondents <- read_csv("table2_maritalstatusparticipants.csv") %>%
mutate(Marital_status = fct_relevel(Marital_status, "Widowed","Living together", "Divorced/separated","Never married","Married"))
names(maritalstatusrespondents)
names(respondentsdata)
# Place of residence
residentrespondents <- read_csv("table2_residenceparticipants.csv") %>%
mutate(Residence = fct_relevel(Residence, "Urban", "Rural"))
names(residentrespondents)
# Education status
educationrespondents <- read_csv("table2_educationstatusparticipants.csv")  %>%
mutate(Education_status = fct_relevel(Education_status, "Vocational", "More than secondary","Secondary", "Primary", "No education"))
names(educationrespondents)
# Wealth quintile
economicstatusrespondents <- read_csv("table2_economicstatus15_49.csv")  %>%
mutate(Wealth_quintile = fct_relevel(Wealth_quintile, "Lowest", "Second","Middle", "Fourth", "Highest"))
names(economicstatusrespondents)
names(respondentsdata)
countyrespondents <- read_csv("table2_participantsbycounty.csv") %>%
arrange(desc(Weighted_percent))
head(countyrespondents)
names(respondentsdata)
names(countyrespondents)
14467+
18142+
5087
12695+25025
# health insurance data
healthinsurancebyage <- read_csv("table3_healthinsurancebyage.csv")
names(healthinsurancebyage)
ggplot(totalinterviewvisuals[totalinterviewvisuals$Gender%in%"All",], aes(x=Respondents, y=numbers, fill=residence)) +
geom_bar(stat = "identity", position = position_dodge()) +
theme_bw() +
geom_text(aes(label=numbers), size=5, color="white")+
coord_flip() + labs(x="Households", y="", fill="Residence")+   scale_fill_manual(values=c("#B26146", "black"))+
facet_grid(residence~selection) +
theme(text= element_text(size = 18, colour = "black", face = "bold")) +
theme(strip.background =element_rect(fill="grey80"))
gplot(totalinterviewvisuals[totalinterviewvisuals$Gender%in%"All",], aes(x=Respondents, y=numbers)) +
geom_bar(stat = "identity", position = position_dodge(), fill="#53A7DC") +
theme_bw() +
geom_text(aes(label=numbers), size=5, color="white")+
coord_flip() + labs(x="Households", y="", fill="Residence")+
facet_grid(residence~selection) +
theme(text= element_text(size = 18, colour = "black", face = "bold")) +
theme(strip.background =element_rect(fill="grey80"))
ggplot(totalinterviewvisuals[totalinterviewvisuals$Gender%in%"All",], aes(x=Respondents, y=numbers)) +
geom_bar(stat = "identity", position = position_dodge(), fill="#53A7DC") +
theme_bw() +
geom_text(aes(label=numbers), size=5, color="white")+
coord_flip() + labs(x="Households", y="", fill="Residence")+
facet_grid(residence~selection) +
theme(text= element_text(size = 18, colour = "black", face = "bold")) +
theme(strip.background =element_rect(fill="grey80"))
ggplot(totalinterviewvisuals[totalinterviewvisuals$Gender%in%"All",], aes(x=Respondents, y=numbers)) +
geom_bar(stat = "identity", position = position_dodge(), fill="#53A7DC") +
theme_bw() +
geom_text(aes(label=numbers), size=5,hjust=2, color="white")+
coord_flip() + labs(x="Households", y="", fill="Residence")+
facet_grid(residence~selection) +
theme(text= element_text(size = 18, colour = "black", face = "bold")) +
theme(strip.background =element_rect(fill="grey80"))
knitr::opts_chunk$set(echo = TRUE)
## Load packages
library(foreign)
library(tidyverse)
library(janitor)
library(haven)
library(sjPlot)
library(arsenal)
library(sf)
library(knitr)
library(DHS.rates)
library(gghighlight)
library(tidyverse)
library(haven)
fpc <- read_csv("table8c_fpusemarriedbycounty.csv")%>%
mutate(County=recode(County,"Tharaka-Nithi"="Tharaka Nithi", "Elgeyo/Marakwet"="Elgeyo Marakwet","Murang’a"="Muranga","Nairobi City"="Nairobi","Taita/Taveta"="Taita Taveta"))
teenpregc <- read_csv("table6_teenpregnancybycounty.csv")%>%
mutate(County=recode(County,"Tharaka-Nithi"="Tharaka Nithi", "Elgeyo/Marakwet"="Elgeyo Marakwet","Murang’a"="Muranga","Nairobi City"="Nairobi","Taita/Taveta"="Taita Taveta"))
knitr::opts_chunk$set(echo = TRUE)
## Load packages
library(foreign)
library(tidyverse)
library(janitor)
library(haven)
library(sjPlot)
library(arsenal)
library(sf)
library(knitr)
library(DHS.rates)
library(gghighlight)
library(tidyverse)
library(haven)
nutc <- read_csv("table14C_nutr_status_by_county.csv")%>%
mutate(County=recode(County,"Tharaka-Nithi"="Tharaka Nithi", "Elgeyo/Marakwet"="Elgeyo Marakwet","Murang’a"="Muranga","Nairobi City"="Nairobi","Taita/Taveta"="Taita Taveta"))
itnc <- read_csv("table18C_ITN_by_county.csv")%>%
mutate(County=recode(County,"Tharaka-Nithi"="Tharaka Nithi", "Elgeyo/Marakwet"="Elgeyo Marakwet","Murang’a"="Muranga","Nairobi City"="Nairobi","Taita/Taveta"="Taita Taveta"))
fpc <- read_csv("table8c_fpusemarriedbycounty.csv")%>%
mutate(County=recode(County,"Tharaka-Nithi"="Tharaka Nithi", "Elgeyo/Marakwet"="Elgeyo Marakwet","Murang’a"="Muranga","Nairobi City"="Nairobi","Taita/Taveta"="Taita Taveta"))
teenpregc <- read_csv("table6_teenpregnancybycounty.csv")%>%
mutate(County=recode(County,"Tharaka-Nithi"="Tharaka Nithi", "Elgeyo/Marakwet"="Elgeyo Marakwet","Murang’a"="Muranga","Nairobi City"="Nairobi","Taita/Taveta"="Taita Taveta"))
violencec <- read_csv("./2022_KDHS/table_29C-Experience_of_physical_violence_by_county")%>%
mutate(County=recode(County,"Tharaka-Nithi"="Tharaka Nithi", "Elgeyo/Marakwet"="Elgeyo Marakwet","Murang’a"="Muranga","Nairobi City"="Nairobi","Taita/Taveta"="Taita Taveta"))
violencec <- read_csv("./2022_KDHS/table_29C-Experience_of_physical_violence_by_county.csv")%>%
mutate(County=recode(County,"Tharaka-Nithi"="Tharaka Nithi", "Elgeyo/Marakwet"="Elgeyo Marakwet","Murang’a"="Muranga","Nairobi City"="Nairobi","Taita/Taveta"="Taita Taveta"))
violencec <- read_csv("./2022_KDHS/table_29C-Experience_of_physical_violence_by_county.csv")%>%
mutate(County=recode(County,"Tharaka-Nithi"="Tharaka Nithi", "Elgeyo/Marakwet"="Elgeyo Marakwet","Murang’a"="Muranga","Nairobi City"="Nairobi","Taita/Taveta"="Taita Taveta"))
violencec <- read_csv("~/2022_KDHS/table_29C-Experience_of_physical_violence_by_county.csv")%>%
mutate(County=recode(County,"Tharaka-Nithi"="Tharaka Nithi", "Elgeyo/Marakwet"="Elgeyo Marakwet","Murang’a"="Muranga","Nairobi City"="Nairobi","Taita/Taveta"="Taita Taveta"))
comb <- nutc%>%left_join(itnc, by="County")
View(comb)
comb <- nutc%>%left_join(itnc, by="County")%>%
left_join(fpc, by="County")%>%
left_join(teenpregc, by="County")
View(comb)
violencec <- read_csv("./2022_KDHS/table_29C-Experience_of_physical_violence_by_county/table_29C_Women.csv")%>%
mutate(County=recode(County,"Tharaka-Nithi"="Tharaka Nithi", "Elgeyo/Marakwet"="Elgeyo Marakwet","Murang’a"="Muranga","Nairobi City"="Nairobi","Taita/Taveta"="Taita Taveta"))
violencec <- read_csv("./table_29C-Experience_of_physical_violence_by_county/table_29C_Women.csv")%>%
mutate(County=recode(County,"Tharaka-Nithi"="Tharaka Nithi", "Elgeyo/Marakwet"="Elgeyo Marakwet","Murang’a"="Muranga","Nairobi City"="Nairobi","Taita/Taveta"="Taita Taveta"))
violencec <- read_csv("./table_29C-Experience_of_physical_violence_by_county/table_29C_Women.csv")
View(violencec)
names(violencec)
violencec <- read_csv("./table_29C-Experience_of_physical_violence_by_county/table_29C_Women.csv")%>%
rename(County=`Background characteristic`)
violencec <- read_csv("./table_29C-Experience_of_physical_violence_by_county/table_29C_Women.csv")%>%
rename(County=`Background characteristic`)
View(violencec)
names(comb)
plot2 <- ggplot(comb%>%filter(indicator%in%"HFA"), aes(x=perc_below2sd, y=Contraceptive_use_any_method)) +
geom_scatter()+
theme_bw()
plot2 <- ggplot(comb%>%filter(indicator%in%"HFA"), aes(x=perc_below2sd, y=Contraceptive_use_any_method)) +
geom_point()+
theme_bw()
plot2
plot2 <- ggplot(comb%>%filter(indicator%in%"HFA"), aes(x=perc_below2sd, y=Contraceptive_use_any_method,color=County)) +
geom_point()+
theme_bw()
plot2
comb <- nutc%>%left_join(itnc, by="County")%>%
left_join(fpc, by="County")%>%
left_join(teenpregc, by="County")%>%
mutate(lab=County)
plot2 <- ggplot(comb%>%filter(indicator%in%"HFA"), aes(x=perc_below2sd, y=Contraceptive_use_any_method,color=County)) +
geom_point()+
theme_bw()+
#labs( y="% of Households with\n at least 1 ITN per 2 persons\n who stayed last night", title="", x="Wealth quintile", fill="")+
#scale_fill_manual(values = c("#f46d43","#fee090","#4575b4"))+
theme(text=element_text(size=12))+
geom_text(aes(label = County), nudge_y = 0.5)
plot2
plot2 <- ggplot(comb%>%filter(indicator%in%"HFA"), aes(x=perc_below2sd, y=Contraceptive_use_any_method,color=County)) +
geom_point()+
theme_bw()+
#labs( y="% of Households with\n at least 1 ITN per 2 persons\n who stayed last night", title="", x="Wealth quintile", fill="")+
#scale_fill_manual(values = c("#f46d43","#fee090","#4575b4"))+
theme(text=element_text(size=12))+
geom_text(aes(label = lab), nudge_y = 0.5)
plot2
plot2 <- ggplot(comb%>%filter(indicator%in%"HFA"), aes(x=perc_below2sd, y=Contraceptive_use_any_method,color=County)) +
geom_point()+
theme_bw()+
labs( y="Contraceptive use", title="", x="% of children severely wasted", fill="")+
#scale_fill_manual(values = c("#f46d43","#fee090","#4575b4"))+
theme(text=element_text(size=12))+
geom_text(aes(label = lab), nudge_y = 0.5)
plot2
ggsave("Comparison trial.png",plot2, width = 15, height=7)
setwd("~/Dropbox/2014 DHS Data/2022_KDHS")
ggsave("Comparison trial.png",plot2, width = 15, height=7)
??jitter
knitr::opts_chunk$set(echo = TRUE)
## Load packages
library(foreign)
library(tidyverse)
library(janitor)
library(haven)
library(sjPlot)
library(arsenal)
library(sf)
library(knitr)
library(DHS.rates)
library(gghighlight)
library(tidyverse)
library(haven)
## call data
nut_age <- read_csv("table14_nutr_status_by_age.csv")
nut_sex <- read_csv("table14_nutr_status_by_sex.csv")%>%
mutate(measure=ifelse(indicator%in%"HFA","Stunting", ifelse(indicator%in%"WFH","Wasting","Underweight")))%>%
mutate(lab = str_c(perc_below2sd,"%"))
nut_res <- read_csv("table14_nutr_status_by_residence.csv")%>%
mutate(measure=ifelse(indicator%in%"HFA","Stunting", ifelse(indicator%in%"WFH","Wasting","Underweight")))%>%
mutate(lab = str_c(perc_below2sd,"%"))
nut_motedu <- read_csv("table14_nutr_status_by_mother_edu.csv")%>%
mutate(`Mother's education`=as.factor(fct_relevel(`Mother's education`, c("No education", "Primary", "Secondary", "More than secondary"))))%>%
mutate(measure=ifelse(indicator%in%"HFA","Stunting", ifelse(indicator%in%"WFH","Wasting","Underweight")))%>%
mutate(lab = str_c(perc_below2sd,"%"))
nut_wealth <- read_csv("table14_nutr_status_by_wealth.csv")%>%
mutate(`Wealth quintile`=as.factor(fct_relevel(`Wealth quintile`, c("Lowest", "Second", "Middle", "Fourth", "Highest"))))%>%
mutate(measure=ifelse(indicator%in%"HFA","Stunting", ifelse(indicator%in%"WFH","Wasting","Underweight")))%>%
mutate(lab = str_c(perc_below2sd,"%"))
nutc <- read_csv("table14C_nutr_status_by_county.csv")%>%
mutate(County=recode(County,"Tharaka-Nithi"="Tharaka Nithi", "Elgeyo/Marakwet"="Elgeyo Marakwet","Murang’a"="Muranga",
"Nairobi City"="Nairobi","Taita/Taveta"="Taita Taveta"))
itn_res <- read_csv("table18_ITN_by_residence.csv")%>%
mutate(lab1 = str_c(perc_atleast_1itn,"%"))%>%
mutate(lab2 = str_c(perc_atleast_1itn_2pple,"%"))
itn_endem <- read_csv("table18_ITN_by_endemicity_zone.csv")%>%
mutate(lab1 = str_c(perc_atleast_1itn,"%"))%>%
mutate(lab2 = str_c(perc_atleast_1itn_2pple,"%"))
itn_wealth <- read_csv("table18_ITN_by_wealth_quintile.csv")%>%
mutate(`Wealth quintile`=as.factor(fct_relevel(`Wealth quintile`, c("Lowest", "Second", "Middle", "Fourth", "Highest"))))%>%
mutate(lab1 = str_c(perc_atleast_1itn,"%"))%>%
mutate(lab2 = str_c(perc_atleast_1itn_2pple,"%"))
itnc <- read_csv("table18C_ITN_by_county.csv")%>%
mutate(County=recode(County,"Tharaka-Nithi"="Tharaka Nithi", "Elgeyo/Marakwet"="Elgeyo Marakwet","Murang’a"="Muranga",
"Nairobi City"="Nairobi","Taita/Taveta"="Taita Taveta"))
county <- st_read("./Kenya County shapefiles/County.shp")%>%
mutate(region=ifelse(Name%in%c("Kilifi","Kwale","Lamu", "Mombasa", "Taita Taveta", "Tana River"),"Coast", ifelse(Name%in%c("Garissa", "Mandera", "Wajir"),"North Eastern", ifelse(Name%in%c("Marsabit","Isiolo","Meru","Tharaka Nithi","Embu","Kitui","Machakos","Makueni"),"Eastern", ifelse(Name%in%c("Kiambu", "Kirinyaga","Muranga","Nyandarua", "Nyeri"),"Central", ifelse(Name%in%c("Bungoma",
"Busia","Kakamega","Vihiga"),"Western", ifelse(Name%in%c("Kisumu", "Siaya","Homa Bay","Kisii", "Migori","Nyamira"),"Nyanza", ifelse(Name%in%"Nairobi","Nairobi", "Rift Valley"))))))))%>%
rename(County=Name)
### dots
nut_motedu_plot <- ggplot(nut_motedu, aes(x=`Mother's education`, y=perc_below2sd, fill=measure)) +
geom_dotplot(binaxis='y', stackdir='center', binwidth = 2)+
geom_jitter()+
theme_bw()+
labs( y="% below -2 SD^2 (Moderate)", title="", x="Mother's education", fill="")+
scale_fill_manual(values = c("#f46d43","#fee090","#4575b4"))+
theme(text=element_text(size=12))+
geom_text(aes(label = lab), nudge_y = 0.5)
nut_motedu_plot
### dots
nut_motedu_plot <- ggplot(nut_motedu, aes(x=`Mother's education`, y=perc_below2sd, fill=measure)) +
geom_dotplot(binaxis='y', stackdir='center', binwidth = 2)+
#geom_jitter()+
theme_bw()+
labs( y="% below -2 SD^2 (Moderate)", title="", x="Mother's education", fill="")+
scale_fill_manual(values = c("#f46d43","#fee090","#4575b4"))+
theme(text=element_text(size=12))+
geom_text(aes(label = lab), nudge_y = 0.5)
nut_motedu_plot
View(itn_res)
names(itn_res)
### plots
itn_res_x <- itn_res%>%
pivot_longer(names_to = "classification", values_to = "proportions")%>%
mutate(classification=recode(classification,"perc_atleast_1itn"="% of Households with\n at least 1 ITN","perc_atleast_1itn_2pple"="% of Households with\n at least 1 ITN per 2 persons\n who stayed last night"))
### plots
itn_res_x <- itn_res%>%
pivot_longer(cols=c(perc_atleast_1itn,perc_atleast_1itn_2pple), names_to = "classification", values_to = "proportions")%>%
mutate(classification=recode(classification,"perc_atleast_1itn"="% of Households with\n at least 1 ITN","perc_atleast_1itn_2pple"="% of Households with\n at least 1 ITN per 2 persons\n who stayed last night"))
itn_res_x
view(itn_res_x)
itn_res1 <- ggplot(itn_res_x,aes(x=Residence, y=proportions, fill=classification))+
geom_bar(position="dodge", stat="identity")+
theme_bw()+
labs( y="%", title="", x="Residence", fill="")+
scale_fill_manual(values = c("#f46d43","#74add1"))+
theme(text=element_text(size=12))
itn_res1
itn_endem_x <- itn_endem%>%
pivot_longer(cols=c(perc_atleast_1itn,perc_atleast_1itn_2pple), names_to = "classification", values_to = "proportions")%>%
mutate(classification=recode(classification,"perc_atleast_1itn"="% of Households with\n at least 1 ITN","perc_atleast_1itn_2pple"="% of Households with\n at least 1 ITN per 2 persons\n who stayed last night"))
itn_end1 <- ggplot(itn_endem_x,aes(x=`Endemicity zone`, y=proportions, fill=classification))+
geom_bar(position="dodge", stat="identity")+
theme_bw()+
labs( y="%", title="", x="Endemicity zone", fill="")+
scale_fill_manual(values = c("#f46d43","#74add1"))+
theme(text=element_text(size=12))
itn_end1
itn_plots2 <- gridExtra::grid.arrange(itn_res1,itn_end1,nrow=1)
ggsave("ITN plots2.png",itn_plots2, width = 15, height=7)
?h_adjust
??h_adjust
itn_end1 <- ggplot(itn_endem_x,aes(x=`Endemicity zone`, y=proportions, fill=classification))+
geom_bar(position="dodge", stat="identity")+
theme_bw()+
labs( y="%", title="", x="Endemicity zone", fill="")+
scale_fill_manual(values = c("#f46d43","#74add1"))+
theme(text=element_text(size=12))+
coord_flip()
itn_plots2 <- gridExtra::grid.arrange(itn_res1,itn_end1,nrow=1)
ggsave("ITN plots2.png",itn_plots2, width = 15, height=7)
